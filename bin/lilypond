#!/usr/bin/env ruby

require 'lyp/version'
require 'lyp'

STDERR.puts "Lyp version #{Lyp::VERSION}"

lilypond_path = Lyp::Lilypond.current_lilypond
unless lilypond_path && File.file?(lilypond_path)
  STDERR.puts "No version of lilypond found. To install lilypond run 'lyp install lilypond'."
  exit 1
end

if (ARGV == ['-v']) || (ARGV == ['--warranty'])
  # Show lilypond version and exit
  exec("#{lilypond_path} #{ARGV.join(' ')}")
end

if ARGV.size == 0
  exec(lilypond_path)
else
  
  begin
    Lyp::Lilypond.compile(ARGV)
  # rescue => e
  #   STDERR.puts e.message
  #   exit 1
  end
end

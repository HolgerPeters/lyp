#!/usr/bin/env ruby

require File.expand_path("../lib/lypack/version", File.dirname(__FILE__))

require File.expand_path("../lib/lypack/directories", File.dirname(__FILE__))
require File.expand_path("../lib/lypack/settings", File.dirname(__FILE__))
require File.expand_path("../lib/lypack/lilypond", File.dirname(__FILE__))

lilypond_path = Lypack::Lilypond.current_lilypond

if (ARGV == ['-v']) || (ARGV == ['--warranty'])
  puts "Lypack version #{Lypack::VERSION}"
  # Show lilypond version and exit
  exec("#{lilypond_path} #{ARGV.join(' ')}")
end

if ARGV.size == 0
  exec(lilypond_path)
else
  
  begin
    Lypack::Lilypond.compile(ARGV)
  rescue => e
    STDERR.puts e.message
    exit 1
  end
end

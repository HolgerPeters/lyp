#!/usr/bin/env ruby

require File.expand_path("../lib/lyp/version", File.dirname(__FILE__))

require File.expand_path("../lib/lyp/directories", File.dirname(__FILE__))
require File.expand_path("../lib/lyp/settings", File.dirname(__FILE__))
require File.expand_path("../lib/lyp/lilypond", File.dirname(__FILE__))

lilypond_path = Lyp::Lilypond.current_lilypond

if (ARGV == ['-v']) || (ARGV == ['--warranty'])
  puts "Lyp version #{Lyp::VERSION}"
  # Show lilypond version and exit
  exec("#{lilypond_path} #{ARGV.join(' ')}")
end

if ARGV.size == 0
  exec(lilypond_path)
else
  
  begin
    Lyp::Lilypond.compile(ARGV)
  rescue => e
    STDERR.puts e.message
    exit 1
  end
end

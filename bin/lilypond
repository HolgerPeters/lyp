#!/usr/bin/env ruby

require 'lyp/version'
require 'lyp'

STDERR.puts "Lyp version #{Lyp::VERSION}"

Lyp::Lilypond.check_lilypond!
lilypond_path = Lyp::Lilypond.current_lilypond
unless lilypond_path && File.file?(lilypond_path)
  STDERR.puts "No version of lilypond found. To install lilypond run 'lyp install lilypond'."
  exit 1
end

case ARGV
when [], ['-v'], ['--warranty'], ['scheme-sandbox']
  exec("#{lilypond_path} #{ARGV.join(' ')}")
else
  begin
    Lyp::Lilypond.compile(ARGV)
  end
end
